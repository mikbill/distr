#!/bin/bash
RM_MIKBILL (){
rm -R /etc/mikbill/
rm -R /var/lib/mysql/
rm -R /var/log/mikbill/
}
MKDIR (){
mkdir -p /etc/mikbill/
mkdir -p /var/lib/mysql/
mkdir -p /var/log/mikbill/
mkdir -p /etc/mikbill/conf.d/ssl
}
WGET (){
#Nginx
wget -P /etc/mikbill/conf.d https://raw.githubusercontent.com/mikbill/distr/master/nginx/conf.d/00_stat_zaglushka_vhost.conf
wget -P /etc/mikbill/conf.d https://raw.githubusercontent.com/mikbill/distr/master/nginx/conf.d/admin_vhost.conf
wget -P /etc/mikbill/conf.d https://raw.githubusercontent.com/mikbill/distr/master/nginx/conf.d/map_vhost.conf
wget -P /etc/mikbill/conf.d https://raw.githubusercontent.com/mikbill/distr/master/nginx/conf.d/stat_vhost.conf
wget -P /etc/mikbill/conf.d/ssl https://raw.githubusercontent.com/mikbill/distr/master/nginx/conf.d/ssl/ca.crt
wget -P /etc/mikbill/conf.d/ssl https://raw.githubusercontent.com/mikbill/distr/master/nginx/conf.d/ssl/ca.key
wget -P /etc/mikbill/ https://raw.githubusercontent.com/mikbill/distr/master/nginx/nginx.conf
#MySQL
wget -P /var/lib/mysql/ https://raw.githubusercontent.com/mikbill/distr/master/mysql/mikbill_5.5.sql
wget -P /var/lib/mysql/ https://raw.githubusercontent.com/mikbill/distr/master/mysql/mikbill_2_0_6_utf8.sql
wget -P /etc/mikbill/ https://raw.githubusercontent.com/mikbill/distr/master/mysql/my.cnf
wget -P /etc/mikbill/ https://raw.githubusercontent.com/mikbill/distr/master/mysql/my-mikbill.cnf
}
NGINX (){
docker rm -f nginx
docker run -p 80:80 -p 443:443 --name nginx -v /etc/mikbill/nginx.conf:/etc/nginx/nginx.conf -v /etc/mikbill/conf.d:/etc/nginx/conf.d -d nginx
}
MYSQL (){
docker rm -f mysql
docker run -p 3306:3306 -v /etc/mikbill/my.cnf:/etc/mysql/conf.d/my.cnf -v /var/lib/mysql:/var/lib/mysql  --name mysql -e MYSQL_ROOT_PASSWORD=$mysql_root_passwd -d mysql:5.5
sed -e "s/MIKBILLPASS/$mysql_mikbill_passwd/g" /var/lib/mysql/mikbill_5.5.sql > /var/lib/mysql/mikbill_5.5.sql2
#Install base
echo "#!/bin/bash" > /var/lib/mysql/base_install.sh
echo "mysql -uroot -p$mysql_root_passwd < /var/lib/mysql/mikbill_5.5.sql2" >> /var/lib/mysql/base_install.sh
echo "mysql -uroot -p$mysql_root_passwd mikbill < /var/lib/mysql/mikbill_2_0_6_utf8.sql" >> /var/lib/mysql/base_install.sh
chmod +x /var/lib/mysql/base_install.sh
}
MYSQL_INSTALL_BASE (){
echo "Скопировать и выполнить:"
echo "/var/lib/mysql/base_install.sh"
docker exec -it mysql bash
}
#MIKBILL_PHP-FPM (){

#}
#RAD_DHCP (){

#}
DOCKER_CLEAR (){
docker rm -f $(docker ps -a -q)
docker rmi -f $(docker images -q)
}
INSTALL_CLEAR (){
rm -f /var/lib/mysql/base_install.sh
rm -f /var/lib/mysql/mikbill_2_0_6_utf8.sql
rm -f /var/lib/mysql/mikbill_5.5.sql
rm -f /var/lib/mysql/mikbill_5.5.sql2
}
